adds type, handling | and #, invoking signatures resolving